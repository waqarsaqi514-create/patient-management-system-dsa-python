{% extends "base.html" %}
{% block content %}
<h2>Billing Calculation</h2>
{% if patient %}
<div class="card">
  <div class="card-body">
    <h5>{{ patient.name }} (ID: {{ patient.patient_id }})</h5>
    <p><strong>Doctor:</strong> {{ patient.doctor }}</p>
    <p><strong>Disease:</strong> {{ patient.disease }}</p>

    <form method="post" class="mt-3">
      <div class="row g-2">
        <div class="col"><input name="base" type="number" step="0.01" placeholder="Base Fee" class="form-control"></div>
        <div class="col"><input name="tests" type="number" step="0.01" placeholder="Tests" class="form-control"></div>
        <div class="col"><input name="meds" type="number" step="0.01" placeholder="Meds" class="form-control"></div>
      </div>
      <button type="submit" class="btn btn-primary mt-2">Calculate Bill</button>
    </form>

    {% if bill is not none %}
    <div class="alert alert-success mt-3">
      <strong>Total Bill: ${{ "%.2f"|format(bill) }}</strong>
    </div>
    <a href="{{ url_for('next_appt', serve=1) }}" class="btn btn-success">Serve Patient & Dequeue</a>
    {% endif %}
  </div>
</div>
{% else %}
<p class="text-info">No appointments in queue.</p>
{% endif %}
{% endblock %}